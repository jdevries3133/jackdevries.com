---
title: Git Describe in Terraform
description: Call git describe --tags and other shell commands from Terraform
created: 2022-05-27
---

# `git describe` in Terraform

It's really easy to get the output of `git describe --tags` using Terraform's
native [external
provider](https://registry.terraform.io/providers/hashicorp/external/latest/docs).

The external provider allows you to run shell commands for the underlying
system. Terraform will let you use the output as long as the output is valid
JSON. Therefore, you can get the git-tag-derived version inside Terraform with
a simple wrapper script:

```bash
#!/bin/sh

# git_describe.sh
# terraform programs must output valid JSON

echo '{"output": "'"$(git describe --tags)"'"}'
```

And you can define it in Terraform like this:

```
data "external" "git_describe" {
  program = ["sh", "scripts/git_describe.sh"]
}
```

Or, you can inline the whole program like so
If you prefer:

```
data "external" "git_describe" {
  program = ["sh", "echo '{\"output\": \"'\"$(git describe --tags)\"'\"}'"]
```

A little messy, to be sure, but a handy one-liner. 

## CI/CD Considerations

Keep in mind that in CI environments, task runners often don't
pull the full project history by default, and that command will
fail in the absence of any tags in the git history. Ensure that
Either, (a) there are some tags in the git history in the CI environment,
or (b) you add your own workaround to the shell script, like falling back to the
git hash of the latest commit (`git rev-parse HEAD`). 
